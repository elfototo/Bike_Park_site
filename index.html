<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <title>BikePark</title>
</head>
<body>

    <!-- Навигация -->
    <section class="navigation">
        <div class="container">
            <div class="navigation__flex">
                <a href="index.html"><img src="img/logo.png" alt="логотип" srcset="" class="logo"></a>
                <ul class="navigation__list">
                    <li><a href="About_us.html" class="navigation__list-title">О нас</a></li>
                    <li><a href="Rent.html" class="navigation__list-title">Аренда</a></li>
                    <li><a href="delivery.html" class="navigation__list-title">Доставка</a></li>
                    <li><a href="locations.html" class="navigation__list-title">Где кататься</a></li>
                    <li><a href="contacts.html" class="navigation__list-title">Контакты</a></li>
                </ul>
                <a href="tel:+971 52 563 4064" class="navigation__phone">+971 52 563 4064</a>
                <a href="#" class="profile"><img src="img/Icon_client's-profile.png" alt="" srcset=""></a>
                <button class="btn-main">feedback</button>
                <div class="clock">
                    <div class="time" id="time"></div>
                    <div class="time-location">Time in your country</div>
                </div>
                <form>
                    <div class="select__wrapper">
                        <select class="selectLang" name="city" id="city-select">
                            <option class="selectLang-item" value="ru">RU</option>
                            <option class="selectLang-item" value="en">EN</option>
                        </select>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- Выбор аренды -->
    <section class="rent">
        <div class="container">
            <div class="accent__backg">
                <div class="rent__choise-header">
                    <h1 class="header__titile">Аренда велосипедов с доставкой</h1>
                    <div class="header__img">
                        <div class="free__helmet">
                            <div class="header__img-item">
                                <img src="img/free_helmet.png" alt="" class="helmet">
                            </div>
                            <div class="header__text">
                                <h2 class="content__h2">Шлем</h2>
                                <h2 class="content__h2-free">Бесплатно</h2>
                            </div>
                        </div>
                        <div class="free__flashlight">
                            <div class="header__img-item">
                                <img src="img/free_flashlight.png" alt="" class="flashlight">
                            </div>
                            <div class="header__text">
                                <h2 class="content__h2">Фонарик</h2>
                                <h2 class="content__h2-free">Бесплатно</h2>
                            </div>
                        </div>
                        <div class="free__lock">
                            <div class="header__img-item">
                                <img src="img/free_lock.png" alt="" class="lock">
                            </div>
                            <div class="header__text">
                                <h2 class="content__h2">Замок</h2>
                                <h2 class="content__h2-free">Бесплатно</h2>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Параметры выбора аренды -->
                <div class="rent__choise-par">
                    <div class="rent__choise-par-flex">
                        <div class="rent__choise-par-item">
                            <p class="content__p ">Тип аренды</p>
                            <div class="rent__choise-par-input">
                                <!-- Выбор по дням -->
                                <label class="radio-label">
                                    <input type="radio" name="choice" id="days" value="days" checked>
                                    <span>По дням</span>
                                </label>
                                <!-- Выбор по часам -->
                                <label class="radio-label">
                                    <input type="radio" name="choice" id="hours" value="hours">
                                    <span>По часам</span>
                                </label>
                            </div>
                        </div>
                        <div class="rent__choise-par-item">
                            <p class="content__p ">Дата и время начала</p>
                            <div class="choice__calendar">
                                <!-- Календарь -->
                                <div class="custom-button" onclick="openCalendar()">
                                    <span id="currentDate"></span>
                                    <span class="arrow-down"><i class="fa fa-chevron-down" aria-hidden="true"></i></span>
                                </div>
                            </div>        
                        </div>
                        <!-- Затемненный фон -->
                        <div class="overlay" id="overlay"></div>
                        <!-- Модальное окно с календарем -->
                        <div id="calendarModal" class="modal">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <div class="modal-header-text">
                                        <div class="modal__title">Свободные даты<br> для бронирования</div>
                                        <div class="modal__text">Городской велосипед Schwinn Traveler 20”</div>
                                    </div>
                                    <div class="btn__close" onclick="closeCalendar()">&#10006;</div>
                                </div>
                                <div class="calendars-container">
                                    <table id="calendar1" class="calendar"></table> <!-- Первый календарь -->
                                    <table id="calendar2" class="calendar"></table> <!-- Второй календарь -->
                                </div>
                                <button class="btn-main" onclick="applyDate()">Применить</button>
                            </div>
                        </div>
                        <div class="rent__choise-par-item">
                            <p class="content__p ">Дата и время конца</p>
                            <div class="rent__choise-par-input">
                            </div>
                        </div>
                        <div class="rent__choise-par-item">
                            <p class="content__p ">Доставка</p>
                            <div class="rent__choise-par-input"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div> 
    </section>

    <!-- Переход -->
    <section class="transition">
        <div class="container">
            <div class="transition__svg">
                <svg xmlns="http://www.w3.org/2000/svg" width="74" height="34" viewBox="0 0 74 34" fill="none">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M0 0H74C64.6112 0 57 7.61116 57 17C57 26.3888 64.6112 34 74 34H0C9.38884 34 17 26.3888 17 17C17 7.61116 9.38884 0 0 0Z" fill="#F2F4F7"/>
                </svg>
            </div>
        </div>
    </section>

    <!-- Тип велосипеда -->
    <section class="tipe">
        <div class="container">
            <div class="accent__backg">
                <p class="content__p tipe__p">Тип велосипеда</p>
                <div class="tipe__flex">
                    <div class="tipe__flex-item">
                        <div class="card">
                            <div class="card__img">
                                <img src="img/bike_photo.png" alt="bike" class="groc">
                            </div>
                            <div class="card__content">
                                <h2 class="content__h2 card__h2">Аллюминий</h2>
                                <div class="price__flex">
                                    <h2 class="content__h2-free">90 AED</h2>
                                    <div class="price__btn">
                                        <button class="btn-main-card">?</button>
                                        <button class="btn-main-card">+</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tipe__flex-item">
                        <div class="card">
                            <div class="card__img">
                                <img src="img/bike_photo.png" alt="bike" class="groc">
                            </div>
                            <div class="card__content">
                                <h2 class="content__h2 card__h2">Аллюминий</h2>
                                <div class="price__flex">
                                    <h2 class="content__h2-free">90 AED</h2>
                                    <div class="price__btn">
                                        <button class="btn-main-card">?</button>
                                        <button class="btn-main-card">+</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tipe__flex-item">
                        <div class="card">
                            <div class="card__img">
                                <img src="img/bike_photo.png" alt="bike" class="groc">
                            </div>
                            <div class="card__content">
                                <h2 class="content__h2 card__h2">Аллюминий</h2>
                                <div class="price__flex">
                                    <h2 class="content__h2-free">90 AED</h2>
                                    <div class="price__btn">
                                        <button class="btn-main-card">?</button>
                                        <button class="btn-main-card">+</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tipe__flex-item">
                        <div class="card">
                            <div class="card__img">
                                <img src="img/bike_photo.png" alt="bike" class="groc">
                            </div>
                            <div class="card__content">
                                <h2 class="content__h2 card__h2">Аллюминий</h2>
                                <div class="price__flex">
                                    <h2 class="content__h2-free">90 AED</h2>
                                    <div class="price__btn">
                                        <button class="btn-main-card">?</button>
                                        <button class="btn-main-card">+</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tipe__btn">
                    <button class="btn-main btn-main__tipe">Найти</button>
                </div>
            </div>
        </div>
    </section>
    <footer>
        <div class="container footer__container">
            <div class="footer__contacts">
                <div class="footer__list">
                    <h3 class="footer__list-title">Аренда Велосипедов</h3>
                    <ul class="footer__list-flex">
                        <li class="footer__list-item">Алюминий</li>
                        <li class="footer__list-item">Карбон</li>
                        <li class="footer__list-item">Горные/городские</li>
                        <li class="footer__list-item">Городские эконом</li>
                    </ul>
                </div>
                <ul class="footer__navigation-flex">
                    <li class="footer__navigation-item">Правила</li>
                    <li class="footer__navigation-item">Отзывы</li>
                    <li class="footer__navigation-item">Контакты</li>
                    <li class="footer__navigation-item">Обратная связь</li>
                </ul>
                
            </div>
            <div class="footer__logo">
                <h3 class="footer__logo">© BikePark, 2021</h3>
                <h3 class="footer__logo">Политика конфиденциальности</h3>
                <div class="footer__social">
                    <img src="img/facebook.png" alt="" class="footer__social-item">
                    <img src="img/instagram.png" alt="" class="footer__social-item">
                </div>
            </div>
        </div>

    </footer>

    <script>
        // Часы
        function formatTime(hours, minutes) {
            let ampm = hours >= 12 ? 'PM' : 'AM';
            hours = (hours % 12) || 12;
            return hours + ':' + (minutes < 10 ? '0' : '') + minutes + ' ' + ampm;
        }

        const getCurrentTime = () => {
            const now = new Date();
            const formattedTime = formatTime(now.getHours(), now.getMinutes());

            document.getElementById('time').innerText = formattedTime;
        }

        getCurrentTime();
        setInterval(getCurrentTime, 60000);

        // JavaScript для текущей даты
        document.getElementById('currentDate').innerText = new Date().toLocaleDateString();

        // Функция для открытия календаря
        function openCalendar() {
            document.getElementById('calendarModal').classList.add('active');
            document.getElementById('overlay').classList.add('active');
            createCalendar(); // Создать календарь
        }
        // Функция для закрытия календаря
        function closeCalendar() {
            document.getElementById('calendarModal').classList.remove('active');
            document.getElementById('overlay').classList.remove('active'); // Скрыть затемненный фон
        }


        // Функция для создания календаря
        function createCalendar() {
            const calendar1 = document.getElementById('calendar1');
            const calendar2 = document.getElementById('calendar2');
            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            let nextMonth = currentMonth + 1;
            let nextYear = currentYear;

            if (nextMonth > 11) {
                nextMonth = 0;
                nextYear++;
            }

            const nextMonthDays = new Date(nextYear, nextMonth + 1, 0).getDate();
            const daysOfWeek = ['Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб', 'Вс'];
            const monthNames = ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь',        'Декабрь'];

            let calendarHTML1 = '';
            let calendarHTML2 = '';

            // Создание первого календаря
            calendarHTML1 += createCalendarHTML(currentYear, currentMonth, daysInMonth, daysOfWeek, monthNames);

            // Создание второго календаря
            calendarHTML2 += createCalendarHTML(nextYear, nextMonth, nextMonthDays, daysOfWeek, monthNames);

            calendar1.innerHTML = calendarHTML1;
            calendar2.innerHTML = calendarHTML2;
        }

        function createCalendarHTML(year, month, totalDays, daysOfWeek, monthNames) {
            const today = new Date();
            const currentYear = today.getFullYear();
            const currentMonth = today.getMonth();
    
            const firstDayOfWeek = new Date(year, month, 1).getDay();
            const lastDayOfMonth = new Date(year, month + 1, 0).getDate();

            let dayIndex = 0;

            let calendarHTML = `
                <tr class="monthNames">
                    <th colspan="7">${monthNames[month]}</th>
                </tr>
                <tr class="daysOfWeek">
                    ${daysOfWeek.map(day => `<th>${day}</th>`).join('')}
                </tr>
                <tr>
            `;

                // Формируем календарь
                for (let i = 0; i < 6; i++) {
                    calendarHTML += '<tr>';
                    for (let j = 0; j < 7; j++) {
                        if (i === 0 && j < firstDayOfWeek) {
                            calendarHTML += '<td></td>';
                        } else {
                            dayIndex++;
                            if (dayIndex <= lastDayOfMonth) {
                                const date = new Date(year, month, dayIndex);
                                const dateString = date.toISOString().split('T')[0];
                                const cellStyle = date < today ? 'color: #CCCCCC;' : '';
                                calendarHTML += `<td class="calendar__day" data-date="${dateString}" style="${cellStyle}" onclick="selectDate('${dateString}', this)">${dayIndex}</td>`;
                            } else {
                                calendarHTML += '<td></td>';
                            }
                        }
                    }
                    calendarHTML += '</tr>';
                }

                return calendarHTML; // Возвращаем сформированный HTML для календаря
                console.log(today)
            }

            let selectedDates = []; // Массив для хранения выбранных дат
            let today = new Date(); // текущая дата
            
        // Функция для выбора даты
        function selectDate(selectedDate, cell) {
            
            const date = new Date(selectedDate);

            if (date <= today) {
                return; // Если выбранная дата меньше или равна текущей дате, прерываем функцию
            }

            if (selectedDates.length < 2) {
                selectedDates.push(date); // Добавляем выбранную дату в массив выбранных дат
                cell.classList.add('selected'); // Добавляем класс для выделения ячейки
            } else {
                const [start, end] = selectedDates; // Получаем начальную и конечную выбранные даты
                const allDates = document.querySelectorAll('.calendar__day'); // Получаем все ячейки календаря

                allDates.forEach(day => {
                    day.classList.remove('selected', 'between'); // Удаляем классы выделения и между датами
                    const dayDate = new Date(day.getAttribute('data-date')); // Получаем дату из ячейки
                    if (dayDate <= today) {
                        day.classList.add('disabled'); // Добавляем класс для отключения старых дат
                    }
                });

                selectedDates = [date]; // Заменяем выбранные даты на новую выбранную
                cell.classList.add('selected'); // Добавляем класс для выделения ячейки
            }

            if (selectedDates.length === 2) {
                const [start, end] = selectedDates; // Получаем начальную и конечную выбранные даты
                const allDates = document.querySelectorAll('.calendar__day'); // Получаем все ячейки календаря

                allDates.forEach(day => {
                    const dayDate = new Date(day.getAttribute('data-date'));
                    if (dayDate > start && dayDate < end && dayDate < end && dayDate > start) {
                        day.classList.add('between'); // Добавляем класс для ячеек между выбранными датами
                    }
                });
            }

            console.log('Selected date:', selectedDate);
        }

        // Функция добавления дат в localStorage
        function applyDate() {
            // Применить выбранные даты
            if (selectedDates.length === 2) {
                localStorage.setItem('startDate', selectedDates[0].toISOString().split('Т')[0])
                localStorage.setItem('endDate', selectedDates[1].toISOString().split('Т')[0])
            }
        }

        // Функция изменения месяца на календаре
        function changeMonth (offset, calendarId) {
            const calendar = document.getElementById(calendarId);
            const currentYear = parseInt(calendar.getAttribute('data-year'));
            const currentMonth = parseInt(calendar.getAttribute('data-month'));
            const newDate = new Date(currentYear, currentMonth + offset, 1);

            calendar.setAttribute('data-year', newDate.getFullYear());
            calendar.setAttribute('data-month', newDate.getMonth());

            createCalendar();
        }


    </script>
    
</body>
</html>